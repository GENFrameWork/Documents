<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GEN FrameWork: D:/Projects/GENFrameWork/GEN/Platforms/Windows/DIOWINDOWSStreamUSBLocalEnumDevices.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Logo_Gen_Little_marco.png"/></td>
  <td id="projectalign">
   <div id="projectname">GEN FrameWork<span id="projectnumber">&#160;0.20.0 (Spartan K5)</span>
   </div>
   <div id="projectbrief">General Framework in C/C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_d_i_o_w_i_n_d_o_w_s_stream_u_s_b_local_enum_devices_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">DIOWINDOWSStreamUSBLocalEnumDevices.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="_d_i_o_w_i_n_d_o_w_s_stream_u_s_b_local_enum_devices_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="comment">/*---- PRECOMPILATION INCLUDES ----------------------------------------------------------------------------------------*/</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#pragma region PRECOMPILATION_INCLUDES</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &quot;<a class="code" href="_g_e_n___defines_8h.html">GEN_Defines.h</a>&quot;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#pragma endregion</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span> </div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#if defined(DIO_ACTIVE) &amp;&amp; defined(DIO_STREAMUSB_ACTIVE)</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="comment">/*---- INCLUDES ------------------------------------------------------------------------------------------------------*/</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#pragma region INCLUDES</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#include &quot;<a class="code" href="_d_i_o_w_i_n_d_o_w_s_stream_u_s_b_local_enum_devices_8h.html">DIOWINDOWSStreamUSBLocalEnumDevices.h</a>&quot;</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span> </div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#include &lt;tchar.h&gt;</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#include &lt;initguid.h&gt;</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#include &lt;winioctl.h&gt;</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#include &lt;cfgmgr32.h&gt;</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#include &lt;usbioctl.h&gt;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span> </div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#include &quot;<a class="code" href="_x_trace_8h.html">XTrace.h</a>&quot;</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span> </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">#include &quot;<a class="code" href="_d_i_o_stream_device_u_s_b_8h.html">DIOStreamDeviceUSB.h</a>&quot;</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="preprocessor">#include &quot;<a class="code" href="_x_memory___control_8h.html">XMemory_Control.h</a>&quot;</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span> </div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">#pragma endregion</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span> </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span> </div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="comment">/*---- GENERAL VARIABLE ----------------------------------------------------------------------------------------------*/</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="preprocessor">#pragma region GENERAL_VARIABLE</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="comment">//This is the GUID for the USB device class</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>DEFINE_GUID(GUID_DEVINTERFACE_USB_PRINT, 0x28D78FAD , 0x5A12, 0x11D1, 0xAE, 0x5B, 0x00, 0x00, 0xF8, 0x03, 0xA8, 0xC2);</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span> </div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="preprocessor">#pragma endregion</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span> </div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="comment">/*---- CLASS MEMBERS -------------------------------------------------------------------------------------------------*/</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="preprocessor">#pragma region CLASS_MEMBERS</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>DIOWINDOWSSTREAMUSBLOCALENUMDEVICES::DIOWINDOWSSTREAMUSBLOCALENUMDEVICES() : <a class="code hl_class" href="class_d_i_o_s_t_r_e_a_m_u_s_b_l_o_c_a_l_e_n_u_m_d_e_v_i_c_e_s.html">DIOSTREAMUSBLOCALENUMDEVICES</a>()</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>{</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>  Clean();</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>}</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>DIOWINDOWSSTREAMUSBLOCALENUMDEVICES::~DIOWINDOWSSTREAMUSBLOCALENUMDEVICES()</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>{</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>  Clean();</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>}</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span><span class="keywordtype">bool</span> DIOWINDOWSSTREAMUSBLOCALENUMDEVICES::Search()</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>{</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>  DelAllDevices();</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span> </div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>  SearchGUID(&amp;GUID_DEVINTERFACE_USB_DEVICE);</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>  SearchGUID(&amp;GUID_DEVINTERFACE_USB_PRINT);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>  SearchAndDeleteEqualDevices();</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span> </div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>}</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span> </div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span><span class="keywordtype">bool</span> DIOWINDOWSSTREAMUSBLOCALENUMDEVICES::SearchGUID(<span class="keyword">const</span> GUID* interfaceclassguid)</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>{</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>  HDEVINFO                         hdevinfo;</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>  SP_DEVICE_INTERFACE_DATA         devinterfacedata;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>  PSP_DEVICE_INTERFACE_DETAIL_DATA devinterfacedetaildata;</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>  SP_DEVINFO_DATA                  devinfodata;</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>  DWORD                            size;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>  DWORD                            memberindex = 0;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span> </div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>  <span class="comment">// We will try to get device information set for all USB devices that have a device interface and are currently present on the system (plugged in).</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>  <span class="comment">//hdevinfo = SetupDiGetClassDevs(NULL, NULL, NULL, DIGCF_DEVICEINTERFACE | DIGCF_PRESENT | DIGCF_ALLCLASSES);</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>  hdevinfo = SetupDiGetClassDevs(&amp;GUID_CLASS_USB_DEVICE, <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, (DIGCF_PRESENT | DIGCF_DEVICEINTERFACE));</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>  <span class="keywordflow">if</span>(hdevinfo != INVALID_HANDLE_VALUE)</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    {</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>      memset(&amp;devinterfacedata, 0, <span class="keyword">sizeof</span>(SP_DEVICE_INTERFACE_DATA));</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span> </div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>      devinterfacedata.cbSize = <span class="keyword">sizeof</span>(SP_DEVICE_INTERFACE_DATA);</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>      memberindex = 0;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span> </div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>      <span class="comment">// Next, we will keep calling this SetupDiEnumDeviceInterfaces(..) until this function causes GetLastError() to return  ERROR_NO_MORE_ITEMS. With each call the memberindex value needs to be incremented to retrieve the next device interface information.</span></div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>      SetupDiEnumDeviceInterfaces(hdevinfo, <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, interfaceclassguid, memberindex, &amp;devinterfacedata);</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span> </div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>      <span class="keywordflow">while</span>(GetLastError() != ERROR_NO_MORE_ITEMS)</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>        {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>          <span class="comment">// As a last step we will need to get some more details for each of device interface information we are able to retrieve. This device interface detail gives us the information we need to identify the device (VID/PID), and decide if it&#39;s useful to us. It will also provide a DEVINFO_DATA structure which we can use to know the serial port name for a virtual com port.</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>          devinfodata.cbSize = <span class="keyword">sizeof</span>(devinfodata);</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>          <span class="comment">// Get the required buffer size. Call SetupDiGetDeviceInterfaceDetail with a NULL devinterfacedetaildata pointer, a devinterfacedetaildataSize  of zero, and a valid RequiredSize variable. In response to such a call, this function returns the required buffer size at size.</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>          SetupDiGetDeviceInterfaceDetail(hdevinfo, &amp;devinterfacedata, <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, &amp;size, <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>          <span class="comment">// Allocate memory for the DeviceInterfaceDetail struct. Don&#39;t forget to deallocate it later!</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>          devinterfacedetaildata = (PSP_DEVICE_INTERFACE_DETAIL_DATA) HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, size);</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>          <span class="keywordflow">if</span>(devinterfacedetaildata)</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>            {</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>              devinterfacedetaildata-&gt;cbSize = <span class="keyword">sizeof</span>(SP_DEVICE_INTERFACE_DETAIL_DATA);</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>              <span class="keywordflow">if</span>(SetupDiGetDeviceInterfaceDetail(hdevinfo, &amp;devinterfacedata, devinterfacedetaildata, size, &amp;size, &amp;devinfodata))</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>                {</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>                  <a class="code hl_class" href="class_d_i_o_s_t_r_e_a_m_d_e_v_i_c_e_u_s_b.html">DIOSTREAMDEVICEUSB</a>* device = <span class="keyword">new</span> <a class="code hl_class" href="class_d_i_o_s_t_r_e_a_m_d_e_v_i_c_e_u_s_b.html">DIOSTREAMDEVICEUSB</a>();</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>                  <span class="keywordflow">if</span>(device)</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>                    {</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                      device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga74026e419acdcfcd941ba928f9523e35">SetIndex</a>(devices.GetSize());</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>                      device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga05b1c51d3917b301fda2a487adb69e39">SetType</a>(<a class="code hl_enumvalue" href="_d_i_o_stream_device_8h.html#a80099bfd286d536dcde19713a1568a8ea6e539eedb045d29ad551c4d078232a4f">DIOSTREAMDEVICE_TYPE_USB</a>);</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>                      device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga13a17779ef8fb0b1c225b7b014c5a421">GetResource</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga4e97e075650e9bc8cfb7deb28e4c9ce4">Set</a>(devinterfacedetaildata-&gt;DevicePath);</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span> </div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>                      <a class="code hl_class" href="class_x_s_t_r_i_n_g.html">XSTRING</a>   trash[2];</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>                      <a class="code hl_class" href="class_x_s_t_r_i_n_g.html">XSTRING</a>   serial;</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>                      <span class="keywordtype">int</span>       vendorID;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>                      <span class="keywordtype">int</span>       productID;</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span> </div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>                      trash[0].<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga5daae19734452be6010c65f3d812aa00">AdjustSize</a>(<a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>);</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>                      trash[1].<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga5daae19734452be6010c65f3d812aa00">AdjustSize</a>(<a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>);</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>                      serial.<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga5daae19734452be6010c65f3d812aa00">AdjustSize</a>(<a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>);</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>                      device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga13a17779ef8fb0b1c225b7b014c5a421">GetResource</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#gaf83a3f5f1eea20e04f8f11d221886633">UnFormat</a>(<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;%s#vid_%04x&amp;pid_%04x#%s#%s&quot;</span>),trash[0].Get(), &amp;vendorID, &amp;productID, serial.<a class="code hl_function" href="group___x_u_t_i_l_s.html#gad1470753a96f93e2feb3ee54e6fef95f">Get</a>(), trash[1].Get());</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span> </div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>                      trash[0].<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga5daae19734452be6010c65f3d812aa00">AdjustSize</a>();</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>                      trash[1].<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga5daae19734452be6010c65f3d812aa00">AdjustSize</a>();</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>                      serial.<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga5daae19734452be6010c65f3d812aa00">AdjustSize</a>();</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>                      device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga713e184339681e876813bdc6afce88d8">GetSerialString</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga4e97e075650e9bc8cfb7deb28e4c9ce4">Set</a>(serial);</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>                      device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga855c4a313c6f3f8b0f1215890617a228">SetVendorID</a>(vendorID);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>                      device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga520a31450526247c291a7295c8763d1f">SetProductID</a>(productID);</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>                      GetInfoFromRegistry(device);</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>                      GetUSBDescriptor(hdevinfo, memberindex, device);</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span> </div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>                      <span class="comment">//device-&gt;DebugPrintInfo();</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>                      devices.Add(device);</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>                    }</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>                }</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>            }</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span> </div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>          HeapFree(GetProcessHeap(), 0, devinterfacedetaildata);</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>          SetupDiEnumDeviceInterfaces( hdevinfo, <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, interfaceclassguid, ++memberindex, &amp;devinterfacedata);</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        }</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span> </div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>      SetupDiDestroyDeviceInfoList(hdevinfo);</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    }</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>}</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span> </div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span><span class="keywordtype">bool</span> DIOWINDOWSSTREAMUSBLOCALENUMDEVICES::GetInfoFromRegistry(<a class="code hl_class" href="class_d_i_o_s_t_r_e_a_m_d_e_v_i_c_e_u_s_b.html">DIOSTREAMDEVICEUSB</a>* device)</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>{</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>  <a class="code hl_class" href="class_x_s_t_r_i_n_g.html">XSTRING</a> name;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>  HKEY    hkey;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>  LONG    statusreg;</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>  <a class="code hl_typedef" href="_x_string_8h.html#a03209152a681f02e4ba73b6681dd4968">XCHAR</a>   value[<a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>];</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>  DWORD   sizevalue;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>  DWORD   type;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>  <span class="keywordtype">int</span>     indexcut;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>  <span class="keywordtype">bool</span>    status;</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span> </div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>  name.<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga2177bf8a150174dfd155c7fe1b7b2af9">Format</a>(<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;SYSTEM\\CurrentControlSet\\Enum\\USB\\VID_%04X&amp;PID_%04X\\%s&quot;</span>), device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga33d6b7a8d3b5dc6b057314dc7c5ea85e">GetVendorID</a>(), device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga5c55be2bf44e6cbd141ef7d29b24b2bc">GetProductID</a>(), device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga713e184339681e876813bdc6afce88d8">GetSerialString</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#gad1470753a96f93e2feb3ee54e6fef95f">Get</a>());</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>  name.<a class="code hl_function" href="group___x_u_t_i_l_s.html#gadf3624dc80b383e22898f1c2f4b6a46c">ToUpperCase</a>();</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span> </div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>  statusreg = RegOpenKeyEx(HKEY_LOCAL_MACHINE, name.<a class="code hl_function" href="group___x_u_t_i_l_s.html#gad1470753a96f93e2feb3ee54e6fef95f">Get</a>(), 0, KEY_QUERY_VALUE, &amp;hkey);</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>  <span class="keywordflow">if</span>(statusreg == ERROR_SUCCESS)</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    {</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>      sizevalue = <a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>-1;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>      memset(value, 0,<a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>);</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>      statusreg = RegQueryValueEx(hkey,<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;LocationInformation&quot;</span>), <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;type, (BYTE*)value, &amp;sizevalue);</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>      <span class="keywordflow">if</span>(statusreg == ERROR_SUCCESS) device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga0144b8c77fee1d0e70d12c2db0919366">GetLocation</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga4e97e075650e9bc8cfb7deb28e4c9ce4">Set</a>(value);</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span> </div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>      sizevalue = <a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>-1;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>      memset(value, 0,<a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>);</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>      statusreg = RegQueryValueEx(hkey,<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;ParentIdPrefix&quot;</span>), <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;type, (BYTE*)value, &amp;sizevalue);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>      <span class="keywordflow">if</span>(statusreg == ERROR_SUCCESS) device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#gae142ea195eb87abf5e66a33b95175b2e">GetParentID</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga4e97e075650e9bc8cfb7deb28e4c9ce4">Set</a>(value);</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>      sizevalue = <a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>-1;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>      memset(value, 0,<a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>);</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>      statusreg = RegQueryValueEx(hkey,<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;DeviceDesc&quot;</span>), <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;type, (BYTE*)value, &amp;sizevalue);</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>      <span class="keywordflow">if</span>(statusreg == ERROR_SUCCESS) device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga57648049e851f7eb500406dbc271b0aa">GetDescription</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga4e97e075650e9bc8cfb7deb28e4c9ce4">Set</a>(value);</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>      indexcut = device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga57648049e851f7eb500406dbc271b0aa">GetDescription</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#gaa5d59b7b88102beb4def8fe054449653">Find</a>(<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;;&quot;</span>), <span class="keyword">true</span>);</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>      <span class="keywordflow">if</span>(indexcut !=  <a class="code hl_define" href="_x_string_8h.html#aee1ccda748b3ca0a483afb84276e3fc6">XSTRING_NOTFOUND</a>) device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga57648049e851f7eb500406dbc271b0aa">GetDescription</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga7ee44788f0c4c71e32d634a155cf6b78">DeleteCharacters</a>(0, indexcut+1);</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>      <a class="code hl_class" href="class_x_s_t_r_i_n_g.html">XSTRING</a> USBclassstring;</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>      <span class="keywordtype">int</span>     USBclass = 0x00;</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>      sizevalue = <a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>-1;</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>      memset(value, 0,<a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>);</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>      statusreg = RegQueryValueEx(hkey,<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;CompatibleIDs&quot;</span>), <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;type, (BYTE*)value, &amp;sizevalue);</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>      <span class="keywordflow">if</span>(statusreg == ERROR_SUCCESS) USBclassstring.<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga4e97e075650e9bc8cfb7deb28e4c9ce4">Set</a>(value);</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>      <span class="keywordflow">if</span>(USBclassstring.<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga7c3fa0dd7b650399470c76192fbd4916">GetSize</a>()) USBclassstring.<a class="code hl_function" href="group___x_u_t_i_l_s.html#gaf83a3f5f1eea20e04f8f11d221886633">UnFormat</a>(<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;USB\\Class_%02x&quot;</span>), &amp;USBclass);</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>      device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#gadc1b8974b96a809f9b984a4b075f32d2">SetClass</a>((<a class="code hl_enumeration" href="_d_i_o_stream_device_u_s_b_8h.html#a95d2fd07e37a18ab5905725b28e13e5e">DIOSTREAMDEVICEUSBCLASS</a>)USBclass);</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span> </div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>      RegCloseKey(hkey);</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>      status = device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#gad0a1f98026ecc0162838d1100c55a7e7">GetName</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga7c3fa0dd7b650399470c76192fbd4916">GetSize</a>()?<span class="keyword">true</span>:<span class="keyword">false</span>;</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>    }</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>   <span class="keywordflow">else</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>    {</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0;c&lt;(int)devices.GetSize();c++)</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>        {</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>          <a class="code hl_class" href="class_d_i_o_s_t_r_e_a_m_d_e_v_i_c_e_u_s_b.html">DIOSTREAMDEVICEUSB</a>* tmpdevice = (<a class="code hl_class" href="class_d_i_o_s_t_r_e_a_m_d_e_v_i_c_e_u_s_b.html">DIOSTREAMDEVICEUSB</a>*)devices.Get(c);</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>          <span class="keywordflow">if</span>(tmpdevice)</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>            {</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>              <span class="keywordflow">if</span>((tmpdevice-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga33d6b7a8d3b5dc6b057314dc7c5ea85e">GetVendorID</a>()== device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga33d6b7a8d3b5dc6b057314dc7c5ea85e">GetVendorID</a>() &amp;&amp; (tmpdevice-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga5c55be2bf44e6cbd141ef7d29b24b2bc">GetProductID</a>())== device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga5c55be2bf44e6cbd141ef7d29b24b2bc">GetProductID</a>()))</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>                {</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>                  <span class="keywordflow">if</span>(device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga713e184339681e876813bdc6afce88d8">GetSerialString</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#gaa5d59b7b88102beb4def8fe054449653">Find</a>((*tmpdevice-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#gae142ea195eb87abf5e66a33b95175b2e">GetParentID</a>()), <span class="keyword">true</span>) != <a class="code hl_define" href="_x_string_8h.html#aee1ccda748b3ca0a483afb84276e3fc6">XSTRING_NOTFOUND</a>)</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>                    {</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>                      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0; d&lt;99; d++)</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>                        {</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>                          name.<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga2177bf8a150174dfd155c7fe1b7b2af9">Format</a>(<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;SYSTEM\\CurrentControlSet\\Enum\\USB\\VID_%04X&amp;PID_%04X&amp;MI_%02d\\%s&quot;</span>), device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga33d6b7a8d3b5dc6b057314dc7c5ea85e">GetVendorID</a>(), device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga5c55be2bf44e6cbd141ef7d29b24b2bc">GetProductID</a>(), d, device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga713e184339681e876813bdc6afce88d8">GetSerialString</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#gad1470753a96f93e2feb3ee54e6fef95f">Get</a>());</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>                          name.<a class="code hl_function" href="group___x_u_t_i_l_s.html#gadf3624dc80b383e22898f1c2f4b6a46c">ToUpperCase</a>();</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span> </div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>                          statusreg = RegOpenKeyEx(HKEY_LOCAL_MACHINE, name.<a class="code hl_function" href="group___x_u_t_i_l_s.html#gad1470753a96f93e2feb3ee54e6fef95f">Get</a>(), 0, KEY_QUERY_VALUE, &amp;hkey);</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>                          <span class="keywordflow">if</span>(statusreg == ERROR_SUCCESS)</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>                            {</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>                              device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga0144b8c77fee1d0e70d12c2db0919366">GetLocation</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga4e97e075650e9bc8cfb7deb28e4c9ce4">Set</a>((*tmpdevice-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga0144b8c77fee1d0e70d12c2db0919366">GetLocation</a>()));</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span> </div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>                              sizevalue = <a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>-1;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>                              memset(value, 0,<a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>);</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>                              statusreg = RegQueryValueEx(hkey,<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;DeviceDesc&quot;</span>), <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;type, (BYTE*)value, &amp;sizevalue);</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>                              <span class="keywordflow">if</span>(statusreg == ERROR_SUCCESS) device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga57648049e851f7eb500406dbc271b0aa">GetDescription</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga4e97e075650e9bc8cfb7deb28e4c9ce4">Set</a>(value);</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>                              indexcut = device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga57648049e851f7eb500406dbc271b0aa">GetDescription</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#gaa5d59b7b88102beb4def8fe054449653">Find</a>(<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;;&quot;</span>), <span class="keyword">true</span>);</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>                              <span class="keywordflow">if</span>(indexcut !=  <a class="code hl_define" href="_x_string_8h.html#aee1ccda748b3ca0a483afb84276e3fc6">XSTRING_NOTFOUND</a>) device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga57648049e851f7eb500406dbc271b0aa">GetDescription</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga7ee44788f0c4c71e32d634a155cf6b78">DeleteCharacters</a>(0, indexcut+1);</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span> </div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>                              <a class="code hl_class" href="class_x_s_t_r_i_n_g.html">XSTRING</a> USBclassstring;</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>                              <span class="keywordtype">int</span>     USBclass = 0x00;</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span> </div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>                              sizevalue = <a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>-1;</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>                              memset(value, 0,<a class="code hl_define" href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a>);</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>                              statusreg = RegQueryValueEx(hkey,<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;CompatibleIDs&quot;</span>), <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;type, (BYTE*)value, &amp;sizevalue);</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>                              <span class="keywordflow">if</span>(statusreg == ERROR_SUCCESS) USBclassstring.<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga4e97e075650e9bc8cfb7deb28e4c9ce4">Set</a>(value);</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>                              <span class="keywordflow">if</span>(USBclassstring.<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga7c3fa0dd7b650399470c76192fbd4916">GetSize</a>()) USBclassstring.<a class="code hl_function" href="group___x_u_t_i_l_s.html#gaf83a3f5f1eea20e04f8f11d221886633">UnFormat</a>(<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;USB\\Class_%02x&quot;</span>), &amp;USBclass);</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>                              device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#gadc1b8974b96a809f9b984a4b075f32d2">SetClass</a>((<a class="code hl_enumeration" href="_d_i_o_stream_device_u_s_b_8h.html#a95d2fd07e37a18ab5905725b28e13e5e">DIOSTREAMDEVICEUSBCLASS</a>)USBclass);</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span> </div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>                              RegCloseKey(hkey);</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span> </div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>                              <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>                            }</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>                        }</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>                    }</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>                }</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>            }</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>        }</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span> </div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>       status = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    }</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span> </div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>  <span class="keywordflow">return</span> status;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>}</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span> </div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span> </div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span><span class="keywordtype">bool</span> DIOWINDOWSSTREAMUSBLOCALENUMDEVICES::GetUSBDescriptor(HDEVINFO&amp; hdevinfo, <span class="keywordtype">int</span> memberindex, <a class="code hl_class" href="class_d_i_o_s_t_r_e_a_m_d_e_v_i_c_e_u_s_b.html">DIOSTREAMDEVICEUSB</a>* device)</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>{</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>  SP_DEVINFO_DATA devicedata;</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>  DEVINST         parentdevinst = 0;</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>  <span class="keywordtype">wchar_t</span>         deviceID[MAX_PATH];</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>  <a class="code hl_class" href="class_x_s_t_r_i_n_g.html">XSTRING</a>         devIDstring;</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>  GUID            classGUID     = GUID_CLASS_USBHUB;</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>  <a class="code hl_class" href="class_x_s_t_r_i_n_g.html">XSTRING</a>         guidString;</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>  <span class="keywordtype">bool</span>            status        = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span> </div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>  devicedata.cbSize = <span class="keyword">sizeof</span>(SP_DEVINFO_DATA);</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span> </div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>  SetupDiEnumDeviceInfo(hdevinfo, memberindex, &amp;devicedata);</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span> </div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>  CM_Get_Parent(&amp;parentdevinst, devicedata.DevInst, 0);</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>  CM_Get_Device_ID(parentdevinst, deviceID, MAX_PATH, 0);</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span> </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>  devIDstring = deviceID;</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>  devIDstring.<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga4a88398821294758d10ec9bde640a4f6">Character_Change</a>(<a class="code hl_define" href="_x_string_8h.html#ab483f167129a5d1941ea1d30f3df8d8a">__C</a>(<span class="charliteral">&#39;\\&#39;</span>), <a class="code hl_define" href="_x_string_8h.html#ab483f167129a5d1941ea1d30f3df8d8a">__C</a>(<span class="charliteral">&#39;#&#39;</span>));</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>  devIDstring.<a class="code hl_function" href="group___x_u_t_i_l_s.html#gaa64ad915c86693c1551c1236f2a10cdb">Insert</a>(<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;\\\\?\\&quot;</span>), 0);</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>  devIDstring.<a class="code hl_function" href="group___x_u_t_i_l_s.html#gae19f84471c20a914d10a8ac757cacb9a">Add</a>(<a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;#&quot;</span>));</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span> </div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>  guidString.<a class="code hl_function" href="group___x_u_t_i_l_s.html#ga2177bf8a150174dfd155c7fe1b7b2af9">Format</a>( <a class="code hl_define" href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a>(<span class="stringliteral">&quot;{%08X-%04X-%04X-%02X%02X-%02X%02X%02X%02X%02X%02X}&quot;</span>) , classGUID.Data1 , classGUID.Data2, classGUID.Data3</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>                                                                               , classGUID.Data4[0]</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>                                                                               , classGUID.Data4[1]</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>                                                                               , classGUID.Data4[2]</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>                                                                               , classGUID.Data4[3]</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>                                                                               , classGUID.Data4[4]</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>                                                                               , classGUID.Data4[5]</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>                                                                               , classGUID.Data4[6]</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>                                                                               , classGUID.Data4[7]);</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span> </div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>  devIDstring.<a class="code hl_function" href="group___x_u_t_i_l_s.html#gae19f84471c20a914d10a8ac757cacb9a">Add</a>(guidString);</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span> </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>  HANDLE handle = CreateFile(devIDstring.<a class="code hl_function" href="group___x_u_t_i_l_s.html#gad1470753a96f93e2feb3ee54e6fef95f">Get</a>(), GENERIC_WRITE, FILE_SHARE_WRITE, <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, OPEN_EXISTING, 0, <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>  <span class="keywordflow">if</span>(handle)</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>    {</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>      DWORD  usbportnumber = 0;</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>      DWORD  requiredsize  = 0;</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span> </div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>      <span class="keywordflow">if</span>(SetupDiGetDeviceRegistryProperty(hdevinfo, &amp;devicedata, SPDRP_ADDRESS, <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, (PBYTE)&amp;usbportnumber, <span class="keyword">sizeof</span>(usbportnumber), &amp;requiredsize))</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>        {</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>          USB_DESCRIPTOR_REQUEST*  requestpacket    = <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>          USB_DEVICE_DESCRIPTOR*   devicedescriptor = <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>          <span class="keywordtype">int</span>                      buffersize       = <span class="keyword">sizeof</span>(USB_DESCRIPTOR_REQUEST) + <span class="keyword">sizeof</span>(USB_DEVICE_DESCRIPTOR);</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>          <a class="code hl_typedef" href="_x_base_8h.html#a7ba3d378cab4450418bec78e604d47da">XBYTE</a>*                   buffer           = <span class="keyword">new</span> <a class="code hl_typedef" href="_x_base_8h.html#a7ba3d378cab4450418bec78e604d47da">XBYTE</a>[buffersize];</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span> </div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>          <span class="keywordflow">if</span>(buffer)</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>            {</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>              <span class="comment">// We know from out previous discussion that the first part of the buffer contains the request packet, and latter part contains the data to be filled by the IOCTL - in our case the device descriptor</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>              requestpacket      = (USB_DESCRIPTOR_REQUEST*)buffer;</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>              devicedescriptor   = (USB_DEVICE_DESCRIPTOR*)((BYTE*)buffer + <span class="keyword">sizeof</span>(USB_DESCRIPTOR_REQUEST));</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span> </div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>              <span class="comment">//fill information in packet</span></div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>              requestpacket-&gt;SetupPacket.bmRequest  = 0x80;</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>              requestpacket-&gt;SetupPacket.bRequest   = USB_REQUEST_GET_DESCRIPTOR;</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>              requestpacket-&gt;ConnectionIndex        = usbportnumber;</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>              requestpacket-&gt;SetupPacket.wValue     = (USB_DEVICE_DESCRIPTOR_TYPE &lt;&lt; 8 | 0 ); <span class="comment">// Since only 1 device descriptor =&gt; index : 0</span></div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>              requestpacket-&gt;SetupPacket.wLength    = <span class="keyword">sizeof</span>(USB_DEVICE_DESCRIPTOR);</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span> </div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>              <span class="comment">// Issue ioctl</span></div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>              DWORD bytesreturned = 0;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>              status = DeviceIoControl(handle, IOCTL_USB_GET_DESCRIPTOR_FROM_NODE_CONNECTION, buffer, buffersize, buffer, buffersize, &amp;bytesreturned, <a class="code hl_define" href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>              <span class="keywordflow">if</span>(status)</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>                {</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>                  device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga53efc6291ac2d604e95ba8b4776b5ff1">GetDescriptor</a>()-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#gab728b20a5d60fc3b609317175da3bca4">SetBCDUSB</a>(devicedescriptor-&gt;bcdUSB);</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>                  device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga53efc6291ac2d604e95ba8b4776b5ff1">GetDescriptor</a>()-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#gaede09506a2fc9805567d511c4fca8f69">SetDeviceClass</a>(devicedescriptor-&gt;bDeviceClass);</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>                  device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga53efc6291ac2d604e95ba8b4776b5ff1">GetDescriptor</a>()-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga1d89ff354913121820d66be24d3ccd9e">SetDeviceSubClass</a>(devicedescriptor-&gt;bDeviceSubClass);</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>                  device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga53efc6291ac2d604e95ba8b4776b5ff1">GetDescriptor</a>()-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga0a0f7b0ade4a101759fe7b2839d694f9">SetDeviceProtocol</a>(devicedescriptor-&gt;bDeviceProtocol);</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>                  device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga53efc6291ac2d604e95ba8b4776b5ff1">GetDescriptor</a>()-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga6af07688f123a942ac3863ac1e4a419c">SetMaxPacketSize</a>(devicedescriptor-&gt;bMaxPacketSize0);</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>                  device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga53efc6291ac2d604e95ba8b4776b5ff1">GetDescriptor</a>()-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga558043044b560a289e345a065448ed86">SetIDVendor</a>(devicedescriptor-&gt;idVendor);</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>                  device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga53efc6291ac2d604e95ba8b4776b5ff1">GetDescriptor</a>()-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#gaafdb1806c9480ab6e4b19d706a5759b7">SetIDProduct</a>(devicedescriptor-&gt;idProduct);</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>                  device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga53efc6291ac2d604e95ba8b4776b5ff1">GetDescriptor</a>()-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga50ceb38c5d66bf7a186b1f56cd431903">SetBCDDevice</a>(devicedescriptor-&gt;bcdDevice);</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>                  device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga53efc6291ac2d604e95ba8b4776b5ff1">GetDescriptor</a>()-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga9cd8b42b58fecc636a148303bcfe07a3">SetManufacturer</a>(devicedescriptor-&gt;iManufacturer);</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>                  device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga53efc6291ac2d604e95ba8b4776b5ff1">GetDescriptor</a>()-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga1407fd8f70a7f245adc10c3ac36109f1">SetProduct</a>(devicedescriptor-&gt;iProduct);</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>                  device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga53efc6291ac2d604e95ba8b4776b5ff1">GetDescriptor</a>()-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga301b40f74519de73c7aa7b59059eecc2">SetSerialNumber</a>(devicedescriptor-&gt;iSerialNumber);</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>                  device-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga53efc6291ac2d604e95ba8b4776b5ff1">GetDescriptor</a>()-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga0c03d74d70252989a66385346645fa2c">SetNumConfigurations</a>(devicedescriptor-&gt;bNumConfigurations);</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>                }</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span> </div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>              <span class="keyword">delete</span> [] buffer;</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>            }</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>        }</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span> </div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>      CloseHandle(handle);</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    }</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>  <span class="keywordflow">return</span> status;</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>}</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span> </div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span><span class="keywordtype">bool</span> DIOWINDOWSSTREAMUSBLOCALENUMDEVICES::SearchAndDeleteEqualDevices()</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>{</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>  <span class="keywordflow">if</span>(devices.IsEmpty()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>  <span class="keywordtype">bool</span> found;</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span> </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>  <span class="keywordflow">do</span>{ found = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span> </div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=0; c&lt;(int)devices.GetSize(); c++)</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>        {</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>          <a class="code hl_class" href="class_d_i_o_s_t_r_e_a_m_d_e_v_i_c_e_u_s_b.html">DIOSTREAMDEVICEUSB</a>* device1 = (<a class="code hl_class" href="class_d_i_o_s_t_r_e_a_m_d_e_v_i_c_e_u_s_b.html">DIOSTREAMDEVICEUSB</a>*)devices.Get(c);</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>          <span class="keywordflow">if</span>(device1)</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>            {</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> d=0; d&lt;(int)devices.GetSize(); d++)</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>                {</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>                  <a class="code hl_class" href="class_d_i_o_s_t_r_e_a_m_d_e_v_i_c_e_u_s_b.html">DIOSTREAMDEVICEUSB</a>* device2 = (<a class="code hl_class" href="class_d_i_o_s_t_r_e_a_m_d_e_v_i_c_e_u_s_b.html">DIOSTREAMDEVICEUSB</a>*)devices.Get(d);</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>                  <span class="keywordflow">if</span>(device2 &amp;&amp; (c!=d))</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>                    {</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>                      <span class="keywordflow">if</span>((!device1-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga0144b8c77fee1d0e70d12c2db0919366">GetLocation</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#gaa41b9d6abe3eca02494d6eb043ed50c2">Compare</a>(device2-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#ga0144b8c77fee1d0e70d12c2db0919366">GetLocation</a>()-&gt;<a class="code hl_function" href="group___x_u_t_i_l_s.html#gad1470753a96f93e2feb3ee54e6fef95f">Get</a>()) &amp;&amp; (device1-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#gaddba0bd1d754af5ed0d9be5f0dd32a0d">GetClass</a>() == device2-&gt;<a class="code hl_function" href="group___d_a_t_a_i_o.html#gaddba0bd1d754af5ed0d9be5f0dd32a0d">GetClass</a>())))</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>                        {</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>                          devices.Delete(device1);</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>                          <span class="keyword">delete</span> device1;</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span> </div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>                          found = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>                          <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>                        }</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>                    }</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>                }</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>              <span class="keywordflow">if</span>(found) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>            }</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>        }</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span> </div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>      <span class="keywordflow">if</span>(!found) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span> </div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>    } <span class="keywordflow">while</span>(1);</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span> </div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>}</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span> </div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span> </div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span><span class="keywordtype">void</span> DIOWINDOWSSTREAMUSBLOCALENUMDEVICES::Clean()</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>{</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span> </div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>}</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span> </div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span> </div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span><span class="preprocessor">#pragma endregion</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span> </div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span> </div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span> </div>
<div class="ttc" id="a_d_i_o_stream_device_8h_html_a80099bfd286d536dcde19713a1568a8ea6e539eedb045d29ad551c4d078232a4f"><div class="ttname"><a href="_d_i_o_stream_device_8h.html#a80099bfd286d536dcde19713a1568a8ea6e539eedb045d29ad551c4d078232a4f">DIOSTREAMDEVICE_TYPE_USB</a></div><div class="ttdeci">@ DIOSTREAMDEVICE_TYPE_USB</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_8h_source.html#l00050">DIOStreamDevice.h:50</a></div></div>
<div class="ttc" id="a_d_i_o_stream_device_u_s_b_8h_html"><div class="ttname"><a href="_d_i_o_stream_device_u_s_b_8h.html">DIOStreamDeviceUSB.h</a></div></div>
<div class="ttc" id="a_d_i_o_stream_device_u_s_b_8h_html_a95d2fd07e37a18ab5905725b28e13e5e"><div class="ttname"><a href="_d_i_o_stream_device_u_s_b_8h.html#a95d2fd07e37a18ab5905725b28e13e5e">DIOSTREAMDEVICEUSBCLASS</a></div><div class="ttdeci">DIOSTREAMDEVICEUSBCLASS</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8h_source.html#l00044">DIOStreamDeviceUSB.h:45</a></div></div>
<div class="ttc" id="a_d_i_o_w_i_n_d_o_w_s_stream_u_s_b_local_enum_devices_8h_html"><div class="ttname"><a href="_d_i_o_w_i_n_d_o_w_s_stream_u_s_b_local_enum_devices_8h.html">DIOWINDOWSStreamUSBLocalEnumDevices.h</a></div></div>
<div class="ttc" id="a_g_e_n___defines_8h_html"><div class="ttname"><a href="_g_e_n___defines_8h.html">GEN_Defines.h</a></div></div>
<div class="ttc" id="a_x_base_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="_x_base_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition</b> <a href="_x_base_8h_source.html#l00086">XBase.h:86</a></div></div>
<div class="ttc" id="a_x_base_8h_html_a647026fb22c438e4f73db846255990e9"><div class="ttname"><a href="_x_base_8h.html#a647026fb22c438e4f73db846255990e9">_MAXSTR</a></div><div class="ttdeci">#define _MAXSTR</div><div class="ttdef"><b>Definition</b> <a href="_x_base_8h_source.html#l00118">XBase.h:118</a></div></div>
<div class="ttc" id="a_x_base_8h_html_a7ba3d378cab4450418bec78e604d47da"><div class="ttname"><a href="_x_base_8h.html#a7ba3d378cab4450418bec78e604d47da">XBYTE</a></div><div class="ttdeci">unsigned char XBYTE</div><div class="ttdef"><b>Definition</b> <a href="_x_base_8h_source.html#l00044">XBase.h:44</a></div></div>
<div class="ttc" id="a_x_memory___control_8h_html"><div class="ttname"><a href="_x_memory___control_8h.html">XMemory_Control.h</a></div></div>
<div class="ttc" id="a_x_string_8h_html_a03209152a681f02e4ba73b6681dd4968"><div class="ttname"><a href="_x_string_8h.html#a03209152a681f02e4ba73b6681dd4968">XCHAR</a></div><div class="ttdeci">wchar_t XCHAR</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8h_source.html#l00049">XString.h:49</a></div></div>
<div class="ttc" id="a_x_string_8h_html_a2cbff438813b72648c18c8af875f47c9"><div class="ttname"><a href="_x_string_8h.html#a2cbff438813b72648c18c8af875f47c9">__L</a></div><div class="ttdeci">#define __L(x)</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8h_source.html#l00092">XString.h:92</a></div></div>
<div class="ttc" id="a_x_string_8h_html_ab483f167129a5d1941ea1d30f3df8d8a"><div class="ttname"><a href="_x_string_8h.html#ab483f167129a5d1941ea1d30f3df8d8a">__C</a></div><div class="ttdeci">#define __C(x)</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8h_source.html#l00093">XString.h:93</a></div></div>
<div class="ttc" id="a_x_string_8h_html_aee1ccda748b3ca0a483afb84276e3fc6"><div class="ttname"><a href="_x_string_8h.html#aee1ccda748b3ca0a483afb84276e3fc6">XSTRING_NOTFOUND</a></div><div class="ttdeci">#define XSTRING_NOTFOUND</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8h_source.html#l00051">XString.h:51</a></div></div>
<div class="ttc" id="a_x_trace_8h_html"><div class="ttname"><a href="_x_trace_8h.html">XTrace.h</a></div></div>
<div class="ttc" id="aclass_d_i_o_s_t_r_e_a_m_d_e_v_i_c_e_u_s_b_html"><div class="ttname"><a href="class_d_i_o_s_t_r_e_a_m_d_e_v_i_c_e_u_s_b.html">DIOSTREAMDEVICEUSB</a></div><div class="ttdoc">Data Input/Output Stream Device USB class.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8h_source.html#l00138">DIOStreamDeviceUSB.h:139</a></div></div>
<div class="ttc" id="aclass_d_i_o_s_t_r_e_a_m_u_s_b_l_o_c_a_l_e_n_u_m_d_e_v_i_c_e_s_html"><div class="ttname"><a href="class_d_i_o_s_t_r_e_a_m_u_s_b_l_o_c_a_l_e_n_u_m_d_e_v_i_c_e_s.html">DIOSTREAMUSBLOCALENUMDEVICES</a></div><div class="ttdoc">Data Input/Output Stream USB local enum class.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_u_s_b_local_enum_devices_8h_source.html#l00056">DIOStreamUSBLocalEnumDevices.h:57</a></div></div>
<div class="ttc" id="aclass_x_s_t_r_i_n_g_html"><div class="ttname"><a href="class_x_s_t_r_i_n_g.html">XSTRING</a></div><div class="ttdoc">eXtended Utils Unicode String class</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8h_source.html#l00141">XString.h:142</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga0144b8c77fee1d0e70d12c2db0919366"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga0144b8c77fee1d0e70d12c2db0919366">DIOSTREAMDEVICEUSB::GetLocation</a></div><div class="ttdeci">XSTRING * GetLocation()</div><div class="ttdoc">GetLocation.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00549">DIOStreamDeviceUSB.cpp:549</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga05b1c51d3917b301fda2a487adb69e39"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga05b1c51d3917b301fda2a487adb69e39">DIOSTREAMDEVICE::SetType</a></div><div class="ttdeci">void SetType(DIOSTREAMDEVICE_TYPE type)</div><div class="ttdoc">SetType.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_8cpp_source.html#l00144">DIOStreamDevice.cpp:144</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga0a0f7b0ade4a101759fe7b2839d694f9"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga0a0f7b0ade4a101759fe7b2839d694f9">DIOSTREAMDEVICEUSB_DESCRIPTOR::SetDeviceProtocol</a></div><div class="ttdeci">void SetDeviceProtocol(XBYTE deviceprotocol)</div><div class="ttdoc">SetDeviceProtocol.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00206">DIOStreamDeviceUSB.cpp:206</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga0c03d74d70252989a66385346645fa2c"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga0c03d74d70252989a66385346645fa2c">DIOSTREAMDEVICEUSB_DESCRIPTOR::SetNumConfigurations</a></div><div class="ttdeci">void SetNumConfigurations(XBYTE numconfigurations)</div><div class="ttdoc">SetNumConfigurations.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00446">DIOStreamDeviceUSB.cpp:446</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga13a17779ef8fb0b1c225b7b014c5a421"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga13a17779ef8fb0b1c225b7b014c5a421">DIOSTREAMDEVICE::GetResource</a></div><div class="ttdeci">XSTRING * GetResource()</div><div class="ttdoc">GetResource.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_8cpp_source.html#l00189">DIOStreamDevice.cpp:189</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga1407fd8f70a7f245adc10c3ac36109f1"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga1407fd8f70a7f245adc10c3ac36109f1">DIOSTREAMDEVICEUSB_DESCRIPTOR::SetProduct</a></div><div class="ttdeci">void SetProduct(XBYTE product)</div><div class="ttdoc">SetProduct.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00386">DIOStreamDeviceUSB.cpp:386</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga1d89ff354913121820d66be24d3ccd9e"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga1d89ff354913121820d66be24d3ccd9e">DIOSTREAMDEVICEUSB_DESCRIPTOR::SetDeviceSubClass</a></div><div class="ttdeci">void SetDeviceSubClass(XBYTE devicesubclass)</div><div class="ttdoc">SetDeviceSubClass.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00176">DIOStreamDeviceUSB.cpp:176</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga301b40f74519de73c7aa7b59059eecc2"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga301b40f74519de73c7aa7b59059eecc2">DIOSTREAMDEVICEUSB_DESCRIPTOR::SetSerialNumber</a></div><div class="ttdeci">void SetSerialNumber(XBYTE serialnumber)</div><div class="ttdoc">SetSerialNumber.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00416">DIOStreamDeviceUSB.cpp:416</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga33d6b7a8d3b5dc6b057314dc7c5ea85e"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga33d6b7a8d3b5dc6b057314dc7c5ea85e">DIOSTREAMDEVICEUSB::GetVendorID</a></div><div class="ttdeci">XWORD GetVendorID()</div><div class="ttdoc">GetVendorID.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00579">DIOStreamDeviceUSB.cpp:579</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga50ceb38c5d66bf7a186b1f56cd431903"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga50ceb38c5d66bf7a186b1f56cd431903">DIOSTREAMDEVICEUSB_DESCRIPTOR::SetBCDDevice</a></div><div class="ttdeci">void SetBCDDevice(XWORD BCDdevice)</div><div class="ttdoc">SetBCDDevice.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00326">DIOStreamDeviceUSB.cpp:326</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga520a31450526247c291a7295c8763d1f"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga520a31450526247c291a7295c8763d1f">DIOSTREAMDEVICEUSB::SetProductID</a></div><div class="ttdeci">void SetProductID(XWORD productID)</div><div class="ttdoc">SetProductID.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00624">DIOStreamDeviceUSB.cpp:624</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga53efc6291ac2d604e95ba8b4776b5ff1"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga53efc6291ac2d604e95ba8b4776b5ff1">DIOSTREAMDEVICEUSB::GetDescriptor</a></div><div class="ttdeci">DIOSTREAMDEVICEUSB_DESCRIPTOR * GetDescriptor()</div><div class="ttdoc">GetDescriptor.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00684">DIOStreamDeviceUSB.cpp:684</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga558043044b560a289e345a065448ed86"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga558043044b560a289e345a065448ed86">DIOSTREAMDEVICEUSB_DESCRIPTOR::SetIDVendor</a></div><div class="ttdeci">void SetIDVendor(XWORD IDvendor)</div><div class="ttdoc">SetIDVendor.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00266">DIOStreamDeviceUSB.cpp:266</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga57648049e851f7eb500406dbc271b0aa"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga57648049e851f7eb500406dbc271b0aa">DIOSTREAMDEVICE::GetDescription</a></div><div class="ttdeci">XSTRING * GetDescription()</div><div class="ttdoc">GetDescription.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_8cpp_source.html#l00174">DIOStreamDevice.cpp:174</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga5c55be2bf44e6cbd141ef7d29b24b2bc"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga5c55be2bf44e6cbd141ef7d29b24b2bc">DIOSTREAMDEVICEUSB::GetProductID</a></div><div class="ttdeci">XWORD GetProductID()</div><div class="ttdoc">GetProductID.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00609">DIOStreamDeviceUSB.cpp:609</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga6af07688f123a942ac3863ac1e4a419c"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga6af07688f123a942ac3863ac1e4a419c">DIOSTREAMDEVICEUSB_DESCRIPTOR::SetMaxPacketSize</a></div><div class="ttdeci">void SetMaxPacketSize(XBYTE maxpacketsize)</div><div class="ttdoc">SetMaxPacketSize.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00236">DIOStreamDeviceUSB.cpp:236</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga713e184339681e876813bdc6afce88d8"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga713e184339681e876813bdc6afce88d8">DIOSTREAMDEVICEUSB::GetSerialString</a></div><div class="ttdeci">XSTRING * GetSerialString()</div><div class="ttdoc">GetSerialString.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00669">DIOStreamDeviceUSB.cpp:669</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga74026e419acdcfcd941ba928f9523e35"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga74026e419acdcfcd941ba928f9523e35">DIOSTREAMDEVICE::SetIndex</a></div><div class="ttdeci">bool SetIndex(int index)</div><div class="ttdoc">SetIndex.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_8cpp_source.html#l00112">DIOStreamDevice.cpp:112</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga855c4a313c6f3f8b0f1215890617a228"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga855c4a313c6f3f8b0f1215890617a228">DIOSTREAMDEVICEUSB::SetVendorID</a></div><div class="ttdeci">void SetVendorID(XWORD vendorID)</div><div class="ttdoc">SetVendorID.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00594">DIOStreamDeviceUSB.cpp:594</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_ga9cd8b42b58fecc636a148303bcfe07a3"><div class="ttname"><a href="group___d_a_t_a_i_o.html#ga9cd8b42b58fecc636a148303bcfe07a3">DIOSTREAMDEVICEUSB_DESCRIPTOR::SetManufacturer</a></div><div class="ttdeci">void SetManufacturer(XBYTE manufacturer)</div><div class="ttdoc">SetManufacturer.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00356">DIOStreamDeviceUSB.cpp:356</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_gaafdb1806c9480ab6e4b19d706a5759b7"><div class="ttname"><a href="group___d_a_t_a_i_o.html#gaafdb1806c9480ab6e4b19d706a5759b7">DIOSTREAMDEVICEUSB_DESCRIPTOR::SetIDProduct</a></div><div class="ttdeci">void SetIDProduct(XWORD IDproduct)</div><div class="ttdoc">SetIDProduct.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00296">DIOStreamDeviceUSB.cpp:296</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_gab728b20a5d60fc3b609317175da3bca4"><div class="ttname"><a href="group___d_a_t_a_i_o.html#gab728b20a5d60fc3b609317175da3bca4">DIOSTREAMDEVICEUSB_DESCRIPTOR::SetBCDUSB</a></div><div class="ttdeci">void SetBCDUSB(XWORD BCDUSB)</div><div class="ttdoc">SetBCDUSB.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00116">DIOStreamDeviceUSB.cpp:116</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_gad0a1f98026ecc0162838d1100c55a7e7"><div class="ttname"><a href="group___d_a_t_a_i_o.html#gad0a1f98026ecc0162838d1100c55a7e7">DIOSTREAMDEVICE::GetName</a></div><div class="ttdeci">XSTRING * GetName()</div><div class="ttdoc">GetName.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_8cpp_source.html#l00159">DIOStreamDevice.cpp:159</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_gadc1b8974b96a809f9b984a4b075f32d2"><div class="ttname"><a href="group___d_a_t_a_i_o.html#gadc1b8974b96a809f9b984a4b075f32d2">DIOSTREAMDEVICEUSB::SetClass</a></div><div class="ttdeci">void SetClass(DIOSTREAMDEVICEUSBCLASS classdev)</div><div class="ttdoc">SetClass.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00654">DIOStreamDeviceUSB.cpp:654</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_gaddba0bd1d754af5ed0d9be5f0dd32a0d"><div class="ttname"><a href="group___d_a_t_a_i_o.html#gaddba0bd1d754af5ed0d9be5f0dd32a0d">DIOSTREAMDEVICEUSB::GetClass</a></div><div class="ttdeci">DIOSTREAMDEVICEUSBCLASS GetClass()</div><div class="ttdoc">GetClass.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00639">DIOStreamDeviceUSB.cpp:639</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_gae142ea195eb87abf5e66a33b95175b2e"><div class="ttname"><a href="group___d_a_t_a_i_o.html#gae142ea195eb87abf5e66a33b95175b2e">DIOSTREAMDEVICEUSB::GetParentID</a></div><div class="ttdeci">XSTRING * GetParentID()</div><div class="ttdoc">GetParentID.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00564">DIOStreamDeviceUSB.cpp:564</a></div></div>
<div class="ttc" id="agroup___d_a_t_a_i_o_html_gaede09506a2fc9805567d511c4fca8f69"><div class="ttname"><a href="group___d_a_t_a_i_o.html#gaede09506a2fc9805567d511c4fca8f69">DIOSTREAMDEVICEUSB_DESCRIPTOR::SetDeviceClass</a></div><div class="ttdeci">void SetDeviceClass(XBYTE deviceclass)</div><div class="ttdoc">SetDeviceClass.</div><div class="ttdef"><b>Definition</b> <a href="_d_i_o_stream_device_u_s_b_8cpp_source.html#l00146">DIOStreamDeviceUSB.cpp:146</a></div></div>
<div class="ttc" id="agroup___x_u_t_i_l_s_html_ga2177bf8a150174dfd155c7fe1b7b2af9"><div class="ttname"><a href="group___x_u_t_i_l_s.html#ga2177bf8a150174dfd155c7fe1b7b2af9">XSTRING::Format</a></div><div class="ttdeci">bool Format(const XCHAR *mask,...)</div><div class="ttdoc">Format.</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8cpp_source.html#l04964">XString.cpp:4964</a></div></div>
<div class="ttc" id="agroup___x_u_t_i_l_s_html_ga4a88398821294758d10ec9bde640a4f6"><div class="ttname"><a href="group___x_u_t_i_l_s.html#ga4a88398821294758d10ec9bde640a4f6">XSTRING::Character_Change</a></div><div class="ttdeci">bool Character_Change(XCHAR source, XCHAR target)</div><div class="ttdoc">Character_Change.</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8cpp_source.html#l01798">XString.cpp:1798</a></div></div>
<div class="ttc" id="agroup___x_u_t_i_l_s_html_ga4e97e075650e9bc8cfb7deb28e4c9ce4"><div class="ttname"><a href="group___x_u_t_i_l_s.html#ga4e97e075650e9bc8cfb7deb28e4c9ce4">XSTRING::Set</a></div><div class="ttdeci">bool Set(XDWORD size)</div><div class="ttdoc">Set.</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8cpp_source.html#l00340">XString.cpp:340</a></div></div>
<div class="ttc" id="agroup___x_u_t_i_l_s_html_ga5daae19734452be6010c65f3d812aa00"><div class="ttname"><a href="group___x_u_t_i_l_s.html#ga5daae19734452be6010c65f3d812aa00">XSTRING::AdjustSize</a></div><div class="ttdeci">bool AdjustSize(XDWORD size, bool ahead=false, XCHAR *characters=NULL, bool addstring=false)</div><div class="ttdoc">AdjustSize.</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8cpp_source.html#l05334">XString.cpp:5334</a></div></div>
<div class="ttc" id="agroup___x_u_t_i_l_s_html_ga7c3fa0dd7b650399470c76192fbd4916"><div class="ttname"><a href="group___x_u_t_i_l_s.html#ga7c3fa0dd7b650399470c76192fbd4916">XSTRING::GetSize</a></div><div class="ttdeci">XDWORD GetSize() const</div><div class="ttdoc">GetSize.</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8cpp_source.html#l00247">XString.cpp:247</a></div></div>
<div class="ttc" id="agroup___x_u_t_i_l_s_html_ga7ee44788f0c4c71e32d634a155cf6b78"><div class="ttname"><a href="group___x_u_t_i_l_s.html#ga7ee44788f0c4c71e32d634a155cf6b78">XSTRING::DeleteCharacters</a></div><div class="ttdeci">bool DeleteCharacters(XDWORD index, XDWORD ncharacteres)</div><div class="ttdoc">DeleteCharacters.</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8cpp_source.html#l01288">XString.cpp:1288</a></div></div>
<div class="ttc" id="agroup___x_u_t_i_l_s_html_gaa41b9d6abe3eca02494d6eb043ed50c2"><div class="ttname"><a href="group___x_u_t_i_l_s.html#gaa41b9d6abe3eca02494d6eb043ed50c2">XSTRING::Compare</a></div><div class="ttdeci">int Compare(const XCHAR *string, bool ignorecase=false)</div><div class="ttdoc">Compare.</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8cpp_source.html#l02013">XString.cpp:2013</a></div></div>
<div class="ttc" id="agroup___x_u_t_i_l_s_html_gaa5d59b7b88102beb4def8fe054449653"><div class="ttname"><a href="group___x_u_t_i_l_s.html#gaa5d59b7b88102beb4def8fe054449653">XSTRING::Find</a></div><div class="ttdeci">int Find(const XCHAR *string, bool ignorecase, int startindex=0)</div><div class="ttdoc">Find.</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8cpp_source.html#l02182">XString.cpp:2182</a></div></div>
<div class="ttc" id="agroup___x_u_t_i_l_s_html_gaa64ad915c86693c1551c1236f2a10cdb"><div class="ttname"><a href="group___x_u_t_i_l_s.html#gaa64ad915c86693c1551c1236f2a10cdb">XSTRING::Insert</a></div><div class="ttdeci">bool Insert(XSTRING str, XDWORD position)</div><div class="ttdoc">Insert.</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8cpp_source.html#l02712">XString.cpp:2712</a></div></div>
<div class="ttc" id="agroup___x_u_t_i_l_s_html_gad1470753a96f93e2feb3ee54e6fef95f"><div class="ttname"><a href="group___x_u_t_i_l_s.html#gad1470753a96f93e2feb3ee54e6fef95f">XSTRING::Get</a></div><div class="ttdeci">XCHAR * Get() const</div><div class="ttdoc">Get.</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8cpp_source.html#l00230">XString.cpp:230</a></div></div>
<div class="ttc" id="agroup___x_u_t_i_l_s_html_gadf3624dc80b383e22898f1c2f4b6a46c"><div class="ttname"><a href="group___x_u_t_i_l_s.html#gadf3624dc80b383e22898f1c2f4b6a46c">XSTRING::ToUpperCase</a></div><div class="ttdeci">bool ToUpperCase()</div><div class="ttdoc">ToUpperCase.</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8cpp_source.html#l01893">XString.cpp:1893</a></div></div>
<div class="ttc" id="agroup___x_u_t_i_l_s_html_gae19f84471c20a914d10a8ac757cacb9a"><div class="ttname"><a href="group___x_u_t_i_l_s.html#gae19f84471c20a914d10a8ac757cacb9a">XSTRING::Add</a></div><div class="ttdeci">bool Add(const char *string)</div><div class="ttdoc">Add.</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8cpp_source.html#l00666">XString.cpp:666</a></div></div>
<div class="ttc" id="agroup___x_u_t_i_l_s_html_gaf83a3f5f1eea20e04f8f11d221886633"><div class="ttname"><a href="group___x_u_t_i_l_s.html#gaf83a3f5f1eea20e04f8f11d221886633">XSTRING::UnFormat</a></div><div class="ttdeci">bool UnFormat(const XCHAR *mask,...)</div><div class="ttdoc">UnFormat.</div><div class="ttdef"><b>Definition</b> <a href="_x_string_8cpp_source.html#l05019">XString.cpp:5019</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2e040ec9b9d60820d043c7ee76236f58.html">GEN</a></li><li class="navelem"><a class="el" href="dir_698557253b32cffe12710934e2777c68.html">Platforms</a></li><li class="navelem"><a class="el" href="dir_423940e8abb60c24d64ecc71c3ac780f.html">Windows</a></li><li class="navelem"><a class="el" href="_d_i_o_w_i_n_d_o_w_s_stream_u_s_b_local_enum_devices_8cpp.html">DIOWINDOWSStreamUSBLocalEnumDevices.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
